from lab_chit import *

prot = """1    0.42993    1.000000
2    0.37324    1.000000
3    0.33383    1.000000
4    0.34153    1.000000
5    0.28699    1.000000
6    0.26458    1.000000
8    0.24415    1.000000
10    0.20547    1.000000
12    0.16726    1.000000
15    0.20603    1.000000
16    0.17510    1.000000
20    0.15427    1.000000
24    0.17030    1.000000
30    0.15062    1.000000
32    0.15961    1.000000
40    0.15694    1.000000
48    0.18438    1.000000
60    0.20505    1.000000
64    0.22715    1.000000
80    0.22658    1.000000
96    0.23453    1.000000
120    0.22361    1.000000
128    0.22449    1.000000
160    0.26496    1.000000
192    0.23631    1.000000
240    0.24265    1.000000
256    0.23838    1.000000
320    0.22835    1.000000
384    0.25197    1.000000
480    0.24910    1.000000
512    0.25753    1.000000
640    0.25599    1.000000
768    0.27803    1.000000
960    0.29951    1.000000
1024    0.30133    1.000000
1280    0.31986    1.000000
1536    0.35877    1.000000
1920    0.39558    1.000000
2048    0.38406    1.000000
2560    0.43578    1.000000
3072    0.46448    1.000000
3840    0.60313    1.000000
4096    0.60907    1.000000
5120    0.75937    1.000000
6144    0.90405    1.000000
7680    1.09589    1.000000
8192    1.16681    1.000000
10240    1.42693    1.000000
12288    1.67904    1.000000
15360    1.97180    1.000000
16384    1.91485    1.000000
20480    2.42965    1.000000
24576    2.80265    1.000000
30720    3.62951    1.000000
"""
x = Var(list(map(float, prot.split()[0::3])), 0)
def f(x): return Var(list(map(float, x.split()[1::3])),0)


max4 = f("""1    0.42993    1.000000
2    0.37324    1.000000
3    0.33383    1.000000
4    0.34153    1.000000
5    0.28699    1.000000
6    0.26458    1.000000
8    0.24415    1.000000
10    0.20547    1.000000
12    0.16726    1.000000
15    0.20603    1.000000
16    0.17510    1.000000
20    0.15427    1.000000
24    0.17030    1.000000
30    0.15062    1.000000
32    0.15961    1.000000
40    0.15694    1.000000
48    0.18438    1.000000
60    0.20505    1.000000
64    0.22715    1.000000
80    0.22658    1.000000
96    0.23453    1.000000
120    0.22361    1.000000
128    0.22449    1.000000
160    0.26496    1.000000
192    0.23631    1.000000
240    0.24265    1.000000
256    0.23838    1.000000
320    0.22835    1.000000
384    0.25197    1.000000
480    0.24910    1.000000
512    0.25753    1.000000
640    0.25599    1.000000
768    0.27803    1.000000
960    0.29951    1.000000
1024    0.30133    1.000000
1280    0.31986    1.000000
1536    0.35877    1.000000
1920    0.39558    1.000000
2048    0.38406    1.000000
2560    0.43578    1.000000
3072    0.46448    1.000000
3840    0.60313    1.000000
4096    0.60907    1.000000
5120    0.75937    1.000000
6144    0.90405    1.000000
7680    1.09589    1.000000
8192    1.16681    1.000000
10240    1.42693    1.000000
12288    1.67904    1.000000
15360    1.97180    1.000000
16384    1.91485    1.000000
20480    2.42965    1.000000
24576    2.80265    1.000000
30720    3.62951    1.000000
""")
avg4 = f("""1    0.42236    1.000000
2    0.44019    1.000000
3    0.40382    1.000000
4    0.34426    1.000000
5    0.31207    1.000000
6    0.27780    1.000000
8    0.24089    1.000000
10    0.29267    1.000000
12    0.31723    1.000000
15    0.27230    1.000000
16    0.30448    1.000000
20    0.25278    1.000000
24    0.23267    1.000000
30    0.26131    1.000000
32    0.23134    1.000000
40    0.25623    1.000000
48    0.24437    1.000000
60    0.23139    1.000000
64    0.24091    1.000000
80    0.23355    1.000000
96    0.25092    1.000000
120    0.23376    1.000000
128    0.23271    1.000000
160    0.24507    1.000000
192    0.22949    1.000000
240    0.25625    1.000000
256    0.23644    1.000000
320    0.26129    1.000000
384    0.26574    1.000000
480    0.25492    1.000000
512    0.29719    1.000000
640    0.26896    1.000000
768    0.28606    1.000000
960    0.31514    1.000000
1024    0.31293    1.000000
1280    0.33762    1.000000
1536    0.37241    1.000000
1920    0.40987    1.000000
2048    0.39523    1.000000
2560    0.44794    1.000000
3072    0.51771    1.000000
3840    0.60561    1.000000
4096    0.59353    1.000000
5120    0.80647    1.000000
6144    0.81787    1.000000
7680    1.15152    1.000000
8192    1.21939    1.000000
10240    1.46217    1.000000
12288    1.76040    1.000000
15360    2.05922    1.000000
16384    2.13852    1.000000
20480    2.37711    1.000000
24576    2.86619    1.000000
30720    3.36234    1.000000""")
min4 = f("""1    0.42951    1.000000
2    0.35191    1.000000
3    0.32678    1.000000
4    0.33868    1.000000
5    0.29513    1.000000
6    0.30861    1.000000
8    0.21509    1.000000
10    0.21383    1.000000
12    0.15739    1.000000
15    0.16847    1.000000
16    0.16322    1.000000
20    0.16771    1.000000
24    0.17557    1.000000
30    0.15609    1.000000
32    0.15106    1.000000
40    0.14028    1.000000
48    0.15148    1.000000
60    0.14719    1.000000
64    0.15785    1.000000
80    0.14818    1.000000
96    0.14323    1.000000
120    0.14695    1.000000
128    0.14654    1.000000
160    0.15788    1.000000
192    0.14956    1.000000
240    0.15975    1.000000
256    0.20238    1.000000
320    0.22700    1.000000
384    0.25193    1.000000
480    0.29142    1.000000
512    0.26025    1.000000
640    0.28056    1.000000
768    0.27397    1.000000
960    0.31015    1.000000
1024    0.32744    1.000000
1280    0.34000    1.000000
1536    0.35921    1.000000
1920    0.39485    1.000000
2048    0.39615    1.000000
2560    0.46060    1.000000
3072    0.48543    1.000000
3840    0.57577    1.000000
4096    0.60658    1.000000
5120    0.70068    1.000000
6144    0.80870    1.000000
7680    1.06475    1.000000
8192    1.19015    1.000000
10240    1.39508    1.000000
12288    1.77052    1.000000
15360    2.13737    1.000000
16384    2.11010    1.000000
20480    2.71749    1.000000
24576    3.45330    1.000000
30720    6.77401    1.000000""")
min4t = f("""1    0.42242    1.000000
2    0.34035    1.000000
3    0.31403    1.000000
4    0.34509    1.000000
5    0.30123    1.000000
6    0.35331    1.000000
8    0.34172    1.000000
10    0.31629    1.000000
12    0.24508    1.000000
15    0.30200    1.000000
16    0.24840    1.000000
20    0.27345    1.000000
24    0.24347    1.000000
30    0.26302    1.000000
32    0.24475    1.000000
40    0.23573    1.000000
48    0.24794    1.000000
60    0.23171    1.000000
64    0.23758    1.000000
80    0.23422    1.000000
96    0.23162    1.000000
120    0.26252    1.000000
128    0.23789    1.000000
160    0.24189    1.000000
192    0.24764    1.000000
240    0.25915    1.000000
256    0.26334    1.000000
320    0.24750    1.000000
384    0.27493    1.000000
480    0.25640    1.000000
512    0.29875    1.000000
640    0.27464    1.000000
768    0.28740    1.000000
960    0.30741    1.000000
1024    0.31857    1.000000
1280    0.33473    1.000000
1536    0.36505    1.000000
1920    0.42074    1.000000
2048    0.40293    1.000000
2560    0.47259    1.000000
3072    0.51516    1.000000
3840    0.56317    1.000000
4096    0.58342    1.000000
5120    0.76676    1.000000
6144    0.91293    1.000000
7680    1.18576    1.000000
8192    1.30982    1.000000
10240    1.43133    1.000000
12288    1.78121    1.000000
15360    2.18057    1.000000
16384    2.19610    1.000000
20480    2.71529    1.000000
24576    2.98291    1.000000
30720    3.69691    1.000000""")

max3 = f("""1    0.41772    1.000000
2    0.40563    1.000000
3    0.34362    1.000000
4    0.34709    1.000000
5    0.29460    1.000000
6    0.23543    1.000000
8    0.23985    1.000000
10    0.26528    1.000000
12    0.28424    1.000000
15    0.30314    1.000000
16    0.28594    1.000000
20    0.27353    1.000000
24    0.28263    1.000000
30    0.26998    1.000000
32    0.27322    1.000000
40    0.26321    1.000000
48    0.26159    1.000000
60    0.26972    1.000000
64    0.28074    1.000000
80    0.27795    1.000000
96    0.27843    1.000000
120    0.26892    1.000000
128    0.28215    1.000000
160    0.26423    1.000000
192    0.28139    1.000000
240    0.27677    1.000000
256    0.27369    1.000000
320    0.27491    1.000000
384    0.30859    1.000000
480    0.29127    1.000000
512    0.29243    1.000000
640    0.31910    1.000000
768    0.31359    1.000000
960    0.32437    1.000000
1024    0.34360    1.000000
1280    0.37009    1.000000
1536    0.38529    1.000000
1920    0.42559    1.000000
2048    0.45019    1.000000
2560    0.47627    1.000000
3072    0.51408    1.000000
3840    0.56160    1.000000
4096    0.57439    1.000000
5120    0.65675    1.000000
6144    0.74941    1.000000
7680    0.89600    1.000000
8192    0.95684    1.000000
10240    1.12722    1.000000
12288    1.55816    1.000000
15360    1.89230    1.000000
16384    1.89962    1.000000
20480    1.99282    1.000000
24576    2.60924    1.000000
30720    3.42159    1.000000""")
avg3 = f("""1    0.43062    1.000000
2    0.44014    1.000000
3    0.39156    1.000000
4    0.35809    1.000000
5    0.28896    1.000000
6    0.25884    1.000000
8    0.21864    1.000000
10    0.20058    1.000000
12    0.19057    1.000000
15    0.19940    1.000000
16    0.23998    1.000000
20    0.26534    1.000000
24    0.27468    1.000000
30    0.26087    1.000000
32    0.27376    1.000000
40    0.26800    1.000000
48    0.27203    1.000000
60    0.26518    1.000000
64    0.26155    1.000000
80    0.27101    1.000000
96    0.27176    1.000000
120    0.27640    1.000000
128    0.27878    1.000000
160    0.31645    1.000000
192    0.27985    1.000000
240    0.28481    1.000000
256    0.28210    1.000000
320    0.28869    1.000000
384    0.28603    1.000000
480    0.30422    1.000000
512    0.29705    1.000000
640    0.31349    1.000000
768    0.32544    1.000000
960    0.34517    1.000000
1024    0.31945    1.000000
1280    0.39463    1.000000
1536    0.40325    1.000000
1920    0.41163    1.000000
2048    0.43500    1.000000
2560    0.47456    1.000000
3072    0.50250    1.000000
3840    0.60994    1.000000
4096    0.57335    1.000000
5120    0.69019    1.000000
6144    0.84542    1.000000
7680    0.88966    1.000000
8192    1.04435    1.000000
10240    1.34386    1.000000
12288    1.25794    1.000000
15360    1.93269    1.000000
16384    2.02871    1.000000
20480    2.66423    1.000000
24576    2.84309    1.000000
30720    3.53981    1.000000""")
min3 = f("""1    0.41931    1.000000
2    0.46040    1.000000
3    0.41498    1.000000
4    0.33573    1.000000
5    0.32095    1.000000
6    0.27166    1.000000
8    0.22645    1.000000
10    0.20198    1.000000
12    0.18865    1.000000
15    0.19574    1.000000
16    0.17361    1.000000
20    0.17335    1.000000
24    1.22627    1.000000
30    0.17750    1.000000
32    0.16288    1.000000
40    0.16948    1.000000
48    0.16691    1.000000
60    0.16757    1.000000
64    0.18966    1.000000
80    0.23775    1.000000
96    0.25628    1.000000
120    0.26048    1.000000
128    0.27186    1.000000
160    0.26676    1.000000
192    0.28018    1.000000
240    0.27246    1.000000
256    0.27850    1.000000
320    0.29508    1.000000
384    0.30938    1.000000
480    0.29906    1.000000
512    0.31207    1.000000
640    0.30015    1.000000
768    0.32808    1.000000
960    0.31225    1.000000
1024    0.35420    1.000000
1280    0.35678    1.000000
1536    0.39189    1.000000
1920    0.41487    1.000000
2048    0.43249    1.000000
2560    0.45236    1.000000
3072    0.50331    1.000000
3840    0.59411    1.000000
4096    0.57591    1.000000
5120    0.66692    1.000000
6144    0.76089    1.000000
7680    0.87438    1.000000
8192    0.92603    1.000000
10240    1.10294    1.000000
12288    1.29397    1.000000
15360    1.80680    1.000000
16384    2.00010    1.000000
20480    2.40102    1.000000
24576    2.80950    1.000000
30720    3.71564    1.000000""")

max2 = f("""1    0.42472    1.000000
2    0.41358    1.000000
3    0.26925    1.000000
4    0.33091    1.000000
5    0.36201    1.000000
6    0.25664    1.000000
8    0.24847    1.000000
10    0.26406    1.000000
12    0.25421    1.000000
15    0.27071    1.000000
16    0.24399    1.000000
20    0.23645    1.000000
24    0.25883    1.000000
30    0.23587    1.000000
32    0.24478    1.000000
40    0.24276    1.000000
48    0.24415    1.000000
60    0.24878    1.000000
64    0.28306    1.000000
80    0.31961    1.000000
96    0.31886    1.000000
120    0.34170    1.000000
128    0.36890    1.000000
160    0.35519    1.000000
192    0.34154    1.000000
240    0.34065    1.000000
256    0.34685    1.000000
320    0.35742    1.000000
384    0.37519    1.000000
480    0.37004    1.000000
512    0.34995    1.000000
640    0.37404    1.000000
768    0.38180    1.000000
960    0.37784    1.000000
1024    0.40669    1.000000
1280    0.41282    1.000000
1536    0.43740    1.000000
1920    0.47091    1.000000
2048    0.45431    1.000000
2560    0.48343    1.000000
3072    0.52176    1.000000
3840    0.59052    1.000000
4096    0.63494    1.000000
5120    0.66056    1.000000
6144    0.74155    1.000000
7680    0.77382    1.000000
8192    0.81353    1.000000
10240    0.98220    1.000000
12288    1.18047    1.000000
15360    1.32487    1.000000
16384    1.40232    1.000000
20480    1.70647    1.000000
24576    2.00179    1.000000
30720    2.33069    1.000000""")
avg2 = f("""1    0.43557    1.000000
2    0.42288    1.000000
3    0.38763    1.000000
4    0.36990    1.000000
5    0.33114    1.000000
6    0.33389    1.000000
8    0.26475    1.000000
10    0.26851    1.000000
12    0.25041    1.000000
15    0.27411    1.000000
16    0.31708    1.000000
20    0.35704    1.000000
24    0.37462    1.000000
30    0.35859    1.000000
32    0.36445    1.000000
40    0.34961    1.000000
48    0.34245    1.000000
60    0.36413    1.000000
64    0.33327    1.000000
80    0.34501    1.000000
96    0.32797    1.000000
120    0.34314    1.000000
128    0.33857    1.000000
160    0.33024    1.000000
192    0.34369    1.000000
240    0.33654    1.000000
256    0.34957    1.000000
320    0.39143    1.000000
384    0.46490    1.000000
480    0.52627    1.000000
512    0.40791    1.000000
640    0.38716    1.000000
768    0.38062    1.000000
960    0.37360    1.000000
1024    0.40668    1.000000
1280    0.43737    1.000000
1536    0.42249    1.000000
1920    0.44831    1.000000
2048    0.47622    1.000000
2560    0.60259    1.000000
3072    0.62345    1.000000
3840    0.65194    1.000000
4096    0.58877    1.000000
5120    0.77760    1.000000
6144    0.75981    1.000000
7680    0.88659    1.000000
8192    1.04232    1.000000
10240    1.17584    1.000000
12288    1.18587    1.000000
15360    1.44306    1.000000
16384    1.42460    1.000000
20480    1.77521    1.000000
24576    2.13854    1.000000
30720    2.50116    1.000000""")
min2 = f("""1    0.43720    1.000000
2    0.31524    1.000000
3    0.28864    1.000000
4    0.26353    1.000000
5    0.27878    1.000000
6    0.28473    1.000000
8    0.26866    1.000000
10    0.26593    1.000000
12    0.25002    1.000000
15    0.23580    1.000000
16    0.24528    1.000000
20    0.23611    1.000000
24    0.24903    1.000000
30    0.23859    1.000000
32    0.23407    1.000000
40    0.24887    1.000000
48    0.23584    1.000000
60    0.24293    1.000000
64    0.23709    1.000000
80    0.24158    1.000000
96    0.24883    1.000000
120    0.26404    1.000000
128    0.25670    1.000000
160    0.26583    1.000000
192    0.23890    1.000000
240    0.26080    1.000000
256    0.24925    1.000000
320    0.25659    1.000000
384    0.26721    1.000000
480    0.26001    1.000000
512    0.26185    1.000000
640    0.26743    1.000000
768    0.26906    1.000000
960    0.27648    1.000000
1024    0.29544    1.000000
1280    0.29097    1.000000
1536    0.31300    1.000000
1920    0.32562    1.000000
2048    0.33741    1.000000
2560    0.36758    1.000000
3072    0.37384    1.000000
3840    0.42110    1.000000
4096    0.40480    1.000000
5120    0.46109    1.000000
6144    0.53085    1.000000
7680    0.60339    1.000000
8192    0.62338    1.000000
10240    0.85845    1.000000
12288    0.86866    1.000000
15360    1.11291    1.000000
16384    1.33856    1.000000
20480    1.74150    1.000000
24576    1.76866    1.000000
30720    2.14974    1.000000""")

max1 = f("""1    0.46293    1.000000
2    0.48589    1.000000
3    0.49547    1.000000
4    0.49836    1.000000
5    0.47311    1.000000
6    0.47516    1.000000
8    0.48858    1.000000
10    0.49063    1.000000
12    0.48208    1.000000
15    0.48256    1.000000
16    0.45821    1.000000
20    0.48613    1.000000
24    0.48073    1.000000
30    0.48165    1.000000
32    0.46571    1.000000
40    0.44872    1.000000
48    0.48179    1.000000
60    0.48793    1.000000
64    0.48281    1.000000
80    0.54546    1.000000
96    0.48277    1.000000
120    0.48951    1.000000
128    0.50230    1.000000
160    0.48955    1.000000
192    0.49577    1.000000
240    0.50396    1.000000
256    0.49290    1.000000
320    0.49975    1.000000
384    0.47174    1.000000
480    0.54390    1.000000
512    0.55584    1.000000
640    0.58250    1.000000
768    0.56515    1.000000
960    0.60233    1.000000
1024    0.59644    1.000000
1280    0.60424    1.000000
1536    0.60643    1.000000
1920    0.62136    1.000000
2048    0.69346    1.000000
2560    0.72820    1.000000
3072    0.65031    1.000000
3840    0.68716    1.000000
4096    0.68044    1.000000
5120    0.69782    1.000000
6144    0.74268    1.000000
7680    0.77871    1.000000
8192    0.81630    1.000000
10240    0.86942    1.000000
12288    0.97275    1.000000
15360    1.00904    1.000000
16384    1.04199    1.000000
20480    1.17830    1.000000
24576    1.37368    1.000000
30720    1.47558    1.000000""")
avg1 = f("""1    0.47556    1.000000
2    0.49571    1.000000
3    0.48926    1.000000
4    0.50303    1.000000
5    0.49043    1.000000
6    0.47031    1.000000
8    0.48298    1.000000
10    0.47792    1.000000
12    0.49295    1.000000
15    0.47684    1.000000
16    0.47039    1.000000
20    0.47767    1.000000
24    0.48047    1.000000
30    0.48191    1.000000
32    0.47930    1.000000
40    0.45943    1.000000
48    0.57517    1.000000
60    0.54655    1.000000
64    0.55153    1.000000
80    0.55699    1.000000
96    0.54772    1.000000
120    0.55145    1.000000
128    0.52857    1.000000
160    0.56289    1.000000
192    0.65091    1.000000
240    0.60454    1.000000
256    0.63156    1.000000
320    0.56225    1.000000
384    0.57060    1.000000
480    0.56965    1.000000
512    0.58709    1.000000
640    0.56300    1.000000
768    0.57550    1.000000
960    0.59643    1.000000
1024    0.61416    1.000000
1280    0.77254    1.000000
1536    0.62328    1.000000
1920    0.58222    1.000000
2048    0.66404    1.000000
2560    0.64215    1.000000
3072    0.65395    1.000000
3840    0.70088    1.000000
4096    0.68439    1.000000
5120    0.71864    1.000000
6144    0.75389    1.000000
7680    0.82206    1.000000
8192    0.82764    1.000000
10240    0.89593    1.000000
12288    0.93181    1.000000
15360    1.06546    1.000000
16384    1.05002    1.000000
20480    1.23075    1.000000
24576    1.31446    1.000000
30720    1.55863    1.000000""")
min1 = f("""1    0.43839    1.000000
2    0.45595    1.000000
3    0.46106    1.000000
4    0.45554    1.000000
5    0.44888    1.000000
6    0.45822    1.000000
8    0.45653    1.000000
10    0.45708    1.000000
12    0.43840    1.000000
15    0.45540    1.000000
16    0.45862    1.000000
20    0.47631    1.000000
24    0.44274    1.000000
30    0.46032    1.000000
32    0.45759    1.000000
40    0.45549    1.000000
48    0.44207    1.000000
60    0.45672    1.000000
64    0.47971    1.000000
80    0.47756    1.000000
96    0.46267    1.000000
120    0.46341    1.000000
128    0.47265    1.000000
160    0.48247    1.000000
192    0.45906    1.000000
240    0.48571    1.000000
256    0.47548    1.000000
320    0.48877    1.000000
384    0.47001    1.000000
480    0.48758    1.000000
512    0.52165    1.000000
640    0.56167    1.000000
768    0.56434    1.000000
960    0.58007    1.000000
1024    0.57533    1.000000
1280    0.57700    1.000000
1536    0.59077    1.000000
1920    0.59496    1.000000
2048    0.60884    1.000000
2560    0.61835    1.000000
3072    0.62848    1.000000
3840    0.66353    1.000000
4096    0.65318    1.000000
5120    0.69378    1.000000
6144    0.72272    1.000000
7680    0.77298    1.000000
8192    0.76279    1.000000
10240    0.86605    1.000000
12288    0.88672    1.000000
15360    0.99473    1.000000
16384    0.98852    1.000000
20480    1.15526    1.000000
24576    1.27125    1.000000
30720    1.43625    1.000000""")

plot(ln(x), ln(max4), label="max4")
# plot(ln(x), ln(avg4), label="avg4")
# plot(ln(x), ln(min4),label="min4")
# plot(ln(x), ln(min4t),label="min4t")

plot(ln(x), ln(max3), label="max3")
# plot(ln(x), ln(avg3), label="avg3")
# plot(ln(x), ln(min3),label="min3")

plot(ln(x), ln(max2), label="max2")
# plot(ln(x), ln(avg2), label="avg2")
# plot(ln(x), ln(min2),label="min2")

plot(ln(x), ln(max1), label="max1")
# plot(ln(x), ln(avg1), label="avg1")
# plot(ln(x), ln(min1),label="min1")
def g(t):
    x = globals()['x']
    k, b = mnk(ln(x), ln(t), not_all=[len(x)-10, None])
    print(k.val())
g(1/3*(max4+avg4+min4))
g(1/3*(max3+avg3+min3))
g(1/3*(max2+avg2+min2))
g(1/3*(max1+avg1+min1))
show(xlabel='ln(N)', ylabel='ln(t)')